{% extends 'questions_list.html' %}
{% block content %}
	<div id="block">
	{% for questions in q_list %}
		<div id = "question">
			
			<form id="ans" method="post">

			{% csrf_token %}

			<div id = "content">

				{% if not questions.author %}
					
				<p class="question-text"> 
					
					<span class = "question-content"> {{questions.question}} </span> 
					
					<h5 class="q-time"> <strong> posted on {{questions.time}} by admin</strong> </h5> 
					
					<a href="{{question.title}}"> {{questions.title}} </a>
					
					<button class = "like-button" type = "button" style = "font-size: 12px;" question = "{{questions.question}}"> 
						<i class = "fas fa-arrow-up"></i>
					</button>
					
					<span class = "like-count">{{ questions.likes }}</span>
				</p>

				{% else %}

				<p class= "question-text"> <span class = "question-content">
					
					<span class = "question-content"> {{questions.question}} </span> <h5 class="q-time"> 
					
					<strong> posted on {{questions.time}} by </strong>
						
					<a href = "/users?user={{questions.author}}"> {{ questions.author }} </a> </h5> 

					<a href="?genre={{questions.title}}"> {{questions.title}} </a> 

					<button class = "like-button" type = "button" style = "font-size: 12px;" question = "{{questions.question}}"> 
						<i class = "fas fa-arrow-up"></i>
					</button>

					<span class = "like-count">{{ questions.likes }}</span>

				</p>

				{% endif %}


				<input type = "hidden" name = "questions" value = "{{questions.question}}">
				<!--<input row = "20" name = "comment" type = "text" placeholder = "Write a comment...">-->
				{% if comments != None %}
					<div class = "comments">
					{% if questions.question == ques %}
						{% for comment in comments %}
								<p> _______________________________________________ </p>
								<p id = "comment-author"> <a href = "/users?user={{comment.author}}" class = "author">{{comment.author}}</a> <span id = "comment-time"> {{comment.time}} </span> </p>
								<p id = "comment-content"> {{comment.content}}</p>			
						{% endfor %}
					{% else %}
					<input id = "show-comments" class = "btn btn-link" type = "submit" name = "act" value = "Show comments"/>
					<br>
					{% endif %}
					</div>
				{% else %}
					<input id = "show-comments" class = "btn btn-link" type = "submit" name = "act" value = "Show comments"/>
					<br>
				{% endif %}
				<br>
				<textarea cols = '30' name = "comment" placeholder = "Write a comment..."></textarea>
				<br>
				<input class = "comment-button" type = "submit" name = "act" value = "Submit">
				{% if author == questions.author.username %}
					<input id = "delete-button" type = "submit" name = "act" value = "Delete">
				{% endif %}
				<br>
				<br>
			</div> 
				
			<div id = "show-answer">
			{% for k, v in q_times.items %}
					{% if k == questions.question %}
						{% if v > 96 %}
							<input type = "submit" name = "show" value = "Show answer"><br>
						{% endif %}
					{% endif %}	
			{% endfor %}
			</div>
			</form>
			{% if answer != None %}
				{% if questions.answer == answer %}
				<p style="margin-top: 10px; font-size: 12px;" id = "answer"> <strong> Answer: </strong> {{ answer }} </p>
				{% endif %}
			{% endif %}
			<br>
			<br>
		</div>
	{% endfor %}
	</div>
	<div id="tags">
	{% for genre in g_list %}
		{% if genre != None %}
			<a class="genre" href="?genre={{genre}}">{{genre}}</a>
			<br>
			<br>
		{% endif %}
	{% endfor %}
	</div>
{% endblock %}

{% block javascript %}


	<script type="text/javascript">

		$('.like-button').click(function()
		{
			// When user clicks like then increment it and then hide the like button 

			console.log('Like button clicked.'); 

			var question = $(this).attr('question');
			var buttons = $('.like-button');
			var likes = $('.like-count');  
			var idx = buttons.index(this); 

			$.get('/like_question', {question : question}, function(data)
			{
				$(this).hide(); 
				likes[idx].innerHTML = data; 
			});

		}); 

		// Smooth scrolling for like, comment, and load buttons 

		$("#show-comments").click(function()
		{
			var elem = document.getElementById('#show-comments'); 

			console.log(elem.offsetTop);

			$('html, body').animate({scrollDown: $(this).offset().top}, 1000); 

		}); 		

	</script>

{% endblock %}